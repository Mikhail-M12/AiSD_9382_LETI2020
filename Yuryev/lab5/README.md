Проверить работу программы можно здесь:
https://repl.it/@yuryev2001/AiSD5lbYuryevSergey9382#main.cpp